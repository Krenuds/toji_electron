<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20241206.2353)
 -->
<!-- Title: startup_solution Pages: 1 -->
<svg width="1895pt" height="1010pt"
 viewBox="0.00 0.00 1895.00 1009.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1005.54)">
<title>startup_solution</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1005.54 1891,-1005.54 1891,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_fix1</title>
<polygon fill="lightblue" stroke="lightblue" points="8,-254.54 8,-675.79 362,-675.79 362,-254.54 8,-254.54"/>
<text text-anchor="middle" x="185" y="-658.49" font-family="Times New Roman,serif" font-size="14.00">FIX 1: Validate Project Path (src/main/index.ts)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_fix2</title>
<polygon fill="lightblue" stroke="lightblue" points="370,-256.29 370,-993.54 672,-993.54 672,-256.29 370,-256.29"/>
<text text-anchor="middle" x="521" y="-976.24" font-family="Times New Roman,serif" font-size="14.00">FIX 2: Fallback Server (src/main/index.ts)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_fix3</title>
<polygon fill="lightblue" stroke="lightblue" points="680,-256.29 680,-983.92 1090,-983.92 1090,-256.29 680,-256.29"/>
<text text-anchor="middle" x="885" y="-966.62" font-family="Times New Roman,serif" font-size="14.00">FIX 3: Better Error Messages (src/main/toji/server.ts)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_implementation</title>
<polygon fill="#e6f3ff" stroke="#e6f3ff" points="1103,-222.92 1103,-863.29 1409,-863.29 1409,-222.92 1103,-222.92"/>
<text text-anchor="middle" x="1256" y="-845.99" font-family="Times New Roman,serif" font-size="14.00">Implementation Order</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_files</title>
<polygon fill="#fff0e6" stroke="#fff0e6" points="1417,-230.79 1417,-358.29 1879,-358.29 1879,-230.79 1417,-230.79"/>
<text text-anchor="middle" x="1648" y="-340.99" font-family="Times New Roman,serif" font-size="14.00">Files to Modify</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_expected</title>
<polygon fill="#e6ffe6" stroke="#e6ffe6" points="141,-70.96 141,-147.46 1111,-147.46 1111,-70.96 141,-70.96"/>
<text text-anchor="middle" x="626" y="-130.16" font-family="Times New Roman,serif" font-size="14.00">Expected Outcomes</text>
</g>
<!-- load_project -->
<g id="node1" class="node">
<title>load_project</title>
<path fill="lightgreen" stroke="black" d="M329.5,-643.29C329.5,-643.29 40.5,-643.29 40.5,-643.29 34.5,-643.29 28.5,-637.29 28.5,-631.29 28.5,-631.29 28.5,-600.04 28.5,-600.04 28.5,-594.04 34.5,-588.04 40.5,-588.04 40.5,-588.04 329.5,-588.04 329.5,-588.04 335.5,-588.04 341.5,-594.04 341.5,-600.04 341.5,-600.04 341.5,-631.29 341.5,-631.29 341.5,-637.29 335.5,-643.29 329.5,-643.29"/>
<text text-anchor="middle" x="185" y="-625.99" font-family="Helvetica,sans-Serif" font-size="14.00">Line 138:</text>
<text text-anchor="middle" x="185" y="-610.24" font-family="Helvetica,sans-Serif" font-size="14.00">const lastProject = config.getCurrentProjectPath()</text>
<text text-anchor="middle" x="185" y="-594.49" font-family="Helvetica,sans-Serif" font-size="14.00">|| config.getOpencodeWorkingDirectory()</text>
</g>
<!-- validate -->
<g id="node2" class="node">
<title>validate</title>
<path fill="lightblue" stroke="black" d="M341.88,-503.54C341.88,-503.54 28.12,-503.54 28.12,-503.54 22.12,-503.54 16.12,-497.54 16.12,-491.54 16.12,-491.54 16.12,-413.04 16.12,-413.04 16.12,-407.04 22.12,-401.04 28.12,-401.04 28.12,-401.04 341.88,-401.04 341.88,-401.04 347.88,-401.04 353.88,-407.04 353.88,-413.04 353.88,-413.04 353.88,-491.54 353.88,-491.54 353.88,-497.54 347.88,-503.54 341.88,-503.54"/>
<text text-anchor="middle" x="185" y="-486.24" font-family="Helvetica,sans-Serif" font-size="14.00">NEW CODE:</text>
<text text-anchor="middle" x="185" y="-470.49" font-family="Helvetica,sans-Serif" font-size="14.00">if (lastProject &amp;&amp; !existsSync(lastProject)) {</text>
<text text-anchor="middle" x="185" y="-454.74" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;logger.warn(&#39;Stored project deleted: %s&#39;, lastProject)</text>
<text text-anchor="middle" x="185" y="-438.99" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;config.setCurrentProjectPath(&#39;&#39;)</text>
<text text-anchor="middle" x="185" y="-423.24" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;lastProject = config.getOpencodeWorkingDirectory()</text>
<text text-anchor="middle" x="185" y="-407.49" font-family="Helvetica,sans-Serif" font-size="14.00">}</text>
</g>
<!-- load_project&#45;&gt;validate -->
<g id="edge1" class="edge">
<title>load_project&#45;&gt;validate</title>
<path fill="none" stroke="black" d="M185,-587.66C185,-567.89 185,-540.27 185,-515.2"/>
<polygon fill="black" stroke="black" points="188.5,-515.42 185,-505.42 181.5,-515.42 188.5,-515.42"/>
</g>
<!-- clean_path -->
<g id="node3" class="node">
<title>clean_path</title>
<path fill="lightgreen" stroke="black" d="M310.12,-302.04C310.12,-302.04 123.88,-302.04 123.88,-302.04 117.88,-302.04 111.88,-296.04 111.88,-290.04 111.88,-290.04 111.88,-274.54 111.88,-274.54 111.88,-268.54 117.88,-262.54 123.88,-262.54 123.88,-262.54 310.12,-262.54 310.12,-262.54 316.12,-262.54 322.12,-268.54 322.12,-274.54 322.12,-274.54 322.12,-290.04 322.12,-290.04 322.12,-296.04 316.12,-302.04 310.12,-302.04"/>
<text text-anchor="middle" x="217" y="-284.74" font-family="Helvetica,sans-Serif" font-size="14.00">Result: lastProject is guaranteed</text>
<text text-anchor="middle" x="217" y="-268.99" font-family="Helvetica,sans-Serif" font-size="14.00">to be a valid directory</text>
</g>
<!-- validate&#45;&gt;clean_path -->
<g id="edge2" class="edge">
<title>validate&#45;&gt;clean_path</title>
<path fill="none" stroke="black" d="M194.6,-400.89C200.04,-372.31 206.67,-337.53 211.3,-313.24"/>
<polygon fill="black" stroke="black" points="214.68,-314.19 213.11,-303.71 207.8,-312.88 214.68,-314.19"/>
</g>
<!-- outcome1 -->
<g id="node20" class="node">
<title>outcome1</title>
<path fill="#ccffcc" stroke="black" d="M374.62,-114.96C374.62,-114.96 161.38,-114.96 161.38,-114.96 155.38,-114.96 149.38,-108.96 149.38,-102.96 149.38,-102.96 149.38,-90.96 149.38,-90.96 149.38,-84.96 155.38,-78.96 161.38,-78.96 161.38,-78.96 374.62,-78.96 374.62,-78.96 380.62,-78.96 386.62,-84.96 386.62,-90.96 386.62,-90.96 386.62,-102.96 386.62,-102.96 386.62,-108.96 380.62,-114.96 374.62,-114.96"/>
<text text-anchor="middle" x="268" y="-91.53" font-family="Helvetica,sans-Serif" font-size="14.00">✅ Stale projects detected &amp; cleared</text>
</g>
<!-- clean_path&#45;&gt;outcome1 -->
<g id="edge17" class="edge">
<title>clean_path&#45;&gt;outcome1</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M222.27,-262.36C231.26,-230.03 249.63,-163.99 260.15,-126.19"/>
<polygon fill="green" stroke="green" points="263.42,-127.47 262.73,-116.89 256.68,-125.59 263.42,-127.47"/>
</g>
<!-- try_start -->
<g id="node4" class="node">
<title>try_start</title>
<path fill="lightgreen" stroke="black" d="M651.62,-961.04C651.62,-961.04 390.38,-961.04 390.38,-961.04 384.38,-961.04 378.38,-955.04 378.38,-949.04 378.38,-949.04 378.38,-917.79 378.38,-917.79 378.38,-911.79 384.38,-905.79 390.38,-905.79 390.38,-905.79 651.62,-905.79 651.62,-905.79 657.62,-905.79 663.62,-911.79 663.62,-917.79 663.62,-917.79 663.62,-949.04 663.62,-949.04 663.62,-955.04 657.62,-961.04 651.62,-961.04"/>
<text text-anchor="middle" x="521" y="-943.74" font-family="Helvetica,sans-Serif" font-size="14.00">try {</text>
<text text-anchor="middle" x="521" y="-927.99" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;await toji.server.start(undefined, lastProject)</text>
<text text-anchor="middle" x="521" y="-912.24" font-family="Helvetica,sans-Serif" font-size="14.00">}</text>
</g>
<!-- catch_enoent -->
<g id="node5" class="node">
<title>catch_enoent</title>
<path fill="lightblue" stroke="black" d="M650.5,-822.67C650.5,-822.67 391.5,-822.67 391.5,-822.67 385.5,-822.67 379.5,-816.67 379.5,-810.67 379.5,-810.67 379.5,-732.17 379.5,-732.17 379.5,-726.17 385.5,-720.17 391.5,-720.17 391.5,-720.17 650.5,-720.17 650.5,-720.17 656.5,-720.17 662.5,-726.17 662.5,-732.17 662.5,-732.17 662.5,-810.67 662.5,-810.67 662.5,-816.67 656.5,-822.67 650.5,-822.67"/>
<text text-anchor="middle" x="521" y="-805.37" font-family="Helvetica,sans-Serif" font-size="14.00">catch (error) {</text>
<text text-anchor="middle" x="521" y="-789.62" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;if (error.message.includes(&#39;ENOENT&#39;)) {</text>
<text text-anchor="middle" x="521" y="-773.87" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;&#160;&#160;logger.warn(&#39;Failed to start project server&#39;)</text>
<text text-anchor="middle" x="521" y="-758.12" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;&#160;&#160;// Fallback logic here</text>
<text text-anchor="middle" x="521" y="-742.37" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;}</text>
<text text-anchor="middle" x="521" y="-726.62" font-family="Helvetica,sans-Serif" font-size="14.00">}</text>
</g>
<!-- try_start&#45;&gt;catch_enoent -->
<g id="edge3" class="edge">
<title>try_start&#45;&gt;catch_enoent</title>
<path fill="none" stroke="black" d="M521,-905.64C521,-886.21 521,-859.11 521,-834.43"/>
<polygon fill="black" stroke="black" points="524.5,-834.43 521,-824.43 517.5,-834.43 524.5,-834.43"/>
<text text-anchor="middle" x="563" y="-874.49" font-family="Times New Roman,serif" font-size="14.00">ENOENT error</text>
</g>
<!-- fallback_server -->
<g id="node6" class="node">
<title>fallback_server</title>
<path fill="lightblue" stroke="black" d="M644.12,-651.17C644.12,-651.17 397.88,-651.17 397.88,-651.17 391.88,-651.17 385.88,-645.17 385.88,-639.17 385.88,-639.17 385.88,-592.17 385.88,-592.17 385.88,-586.17 391.88,-580.17 397.88,-580.17 397.88,-580.17 644.12,-580.17 644.12,-580.17 650.12,-580.17 656.12,-586.17 656.12,-592.17 656.12,-592.17 656.12,-639.17 656.12,-639.17 656.12,-645.17 650.12,-651.17 644.12,-651.17"/>
<text text-anchor="middle" x="521" y="-633.87" font-family="Helvetica,sans-Serif" font-size="14.00">NEW CODE:</text>
<text text-anchor="middle" x="521" y="-618.12" font-family="Helvetica,sans-Serif" font-size="14.00">logger.info(&#39;Starting fallback global server&#39;)</text>
<text text-anchor="middle" x="521" y="-602.37" font-family="Helvetica,sans-Serif" font-size="14.00">const cwdPath = process.cwd()</text>
<text text-anchor="middle" x="521" y="-586.62" font-family="Helvetica,sans-Serif" font-size="14.00">await toji.server.start(undefined, cwdPath)</text>
</g>
<!-- catch_enoent&#45;&gt;fallback_server -->
<g id="edge4" class="edge">
<title>catch_enoent&#45;&gt;fallback_server</title>
<path fill="none" stroke="black" d="M521,-720.07C521,-701.68 521,-680.98 521,-662.96"/>
<polygon fill="black" stroke="black" points="524.5,-663.07 521,-653.07 517.5,-663.07 524.5,-663.07"/>
</g>
<!-- connect_fallback -->
<g id="node7" class="node">
<title>connect_fallback</title>
<path fill="lightblue" stroke="black" d="M649.38,-472.04C649.38,-472.04 392.62,-472.04 392.62,-472.04 386.62,-472.04 380.62,-466.04 380.62,-460.04 380.62,-460.04 380.62,-444.54 380.62,-444.54 380.62,-438.54 386.62,-432.54 392.62,-432.54 392.62,-432.54 649.38,-432.54 649.38,-432.54 655.38,-432.54 661.38,-438.54 661.38,-444.54 661.38,-444.54 661.38,-460.04 661.38,-460.04 661.38,-466.04 655.38,-472.04 649.38,-472.04"/>
<text text-anchor="middle" x="521" y="-454.74" font-family="Helvetica,sans-Serif" font-size="14.00">await toji.connectClient(cwdPath)</text>
<text text-anchor="middle" x="521" y="-438.99" font-family="Helvetica,sans-Serif" font-size="14.00">await toji.changeWorkingDirectory(cwdPath)</text>
</g>
<!-- fallback_server&#45;&gt;connect_fallback -->
<g id="edge5" class="edge">
<title>fallback_server&#45;&gt;connect_fallback</title>
<path fill="none" stroke="black" d="M521,-580.05C521,-551.33 521,-510.9 521,-483.48"/>
<polygon fill="black" stroke="black" points="524.5,-483.76 521,-473.76 517.5,-483.76 524.5,-483.76"/>
</g>
<!-- success -->
<g id="node8" class="node">
<title>success</title>
<path fill="lightgreen" stroke="black" d="M614.12,-300.29C614.12,-300.29 427.88,-300.29 427.88,-300.29 421.88,-300.29 415.88,-294.29 415.88,-288.29 415.88,-288.29 415.88,-276.29 415.88,-276.29 415.88,-270.29 421.88,-264.29 427.88,-264.29 427.88,-264.29 614.12,-264.29 614.12,-264.29 620.12,-264.29 626.12,-270.29 626.12,-276.29 626.12,-276.29 626.12,-288.29 626.12,-288.29 626.12,-294.29 620.12,-300.29 614.12,-300.29"/>
<text text-anchor="middle" x="521" y="-276.87" font-family="Helvetica,sans-Serif" font-size="14.00">App functional with global server</text>
</g>
<!-- connect_fallback&#45;&gt;success -->
<g id="edge6" class="edge">
<title>connect_fallback&#45;&gt;success</title>
<path fill="none" stroke="black" d="M521,-432.35C521,-402.95 521,-346.15 521,-311.79"/>
<polygon fill="black" stroke="black" points="524.5,-312.17 521,-302.17 517.5,-312.17 524.5,-312.17"/>
</g>
<!-- outcome2 -->
<g id="node21" class="node">
<title>outcome2</title>
<path fill="#ccffcc" stroke="black" d="M625.38,-114.96C625.38,-114.96 416.62,-114.96 416.62,-114.96 410.62,-114.96 404.62,-108.96 404.62,-102.96 404.62,-102.96 404.62,-90.96 404.62,-90.96 404.62,-84.96 410.62,-78.96 416.62,-78.96 416.62,-78.96 625.38,-78.96 625.38,-78.96 631.38,-78.96 637.38,-84.96 637.38,-90.96 637.38,-90.96 637.38,-102.96 637.38,-102.96 637.38,-108.96 631.38,-114.96 625.38,-114.96"/>
<text text-anchor="middle" x="521" y="-91.53" font-family="Helvetica,sans-Serif" font-size="14.00">✅ Fallback server always available</text>
</g>
<!-- success&#45;&gt;outcome2 -->
<g id="edge18" class="edge">
<title>success&#45;&gt;outcome2</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M521,-264.05C521,-232.52 521,-165.28 521,-126.72"/>
<polygon fill="green" stroke="green" points="524.5,-126.81 521,-116.81 517.5,-126.81 524.5,-126.81"/>
</g>
<!-- spawn_error -->
<g id="node9" class="node">
<title>spawn_error</title>
<path fill="yellow" stroke="black" d="M989,-951.42C989,-951.42 781,-951.42 781,-951.42 775,-951.42 769,-945.42 769,-939.42 769,-939.42 769,-927.42 769,-927.42 769,-921.42 775,-915.42 781,-915.42 781,-915.42 989,-915.42 989,-915.42 995,-915.42 1001,-921.42 1001,-927.42 1001,-927.42 1001,-939.42 1001,-939.42 1001,-945.42 995,-951.42 989,-951.42"/>
<text text-anchor="middle" x="885" y="-927.99" font-family="Helvetica,sans-Serif" font-size="14.00">spawnOpenCodeServer catch block</text>
</g>
<!-- check_binary -->
<g id="node10" class="node">
<title>check_binary</title>
<path fill="lightblue" stroke="black" d="M1012.25,-791.17C1012.25,-791.17 757.75,-791.17 757.75,-791.17 751.75,-791.17 745.75,-785.17 745.75,-779.17 745.75,-779.17 745.75,-763.67 745.75,-763.67 745.75,-757.67 751.75,-751.67 757.75,-751.67 757.75,-751.67 1012.25,-751.67 1012.25,-751.67 1018.25,-751.67 1024.25,-757.67 1024.25,-763.67 1024.25,-763.67 1024.25,-779.17 1024.25,-779.17 1024.25,-785.17 1018.25,-791.17 1012.25,-791.17"/>
<text text-anchor="middle" x="885" y="-773.87" font-family="Helvetica,sans-Serif" font-size="14.00">NEW CODE:</text>
<text text-anchor="middle" x="885" y="-758.12" font-family="Helvetica,sans-Serif" font-size="14.00">const binaryExists = existsSync(binaryPath)</text>
</g>
<!-- spawn_error&#45;&gt;check_binary -->
<g id="edge7" class="edge">
<title>spawn_error&#45;&gt;check_binary</title>
<path fill="none" stroke="black" d="M885,-914.99C885,-888.08 885,-836.07 885,-802.86"/>
<polygon fill="black" stroke="black" points="888.5,-803.07 885,-793.07 881.5,-803.07 888.5,-803.07"/>
</g>
<!-- check_cwd -->
<g id="node11" class="node">
<title>check_cwd</title>
<path fill="lightblue" stroke="black" d="M1009.25,-635.42C1009.25,-635.42 760.75,-635.42 760.75,-635.42 754.75,-635.42 748.75,-629.42 748.75,-623.42 748.75,-623.42 748.75,-607.92 748.75,-607.92 748.75,-601.92 754.75,-595.92 760.75,-595.92 760.75,-595.92 1009.25,-595.92 1009.25,-595.92 1015.25,-595.92 1021.25,-601.92 1021.25,-607.92 1021.25,-607.92 1021.25,-623.42 1021.25,-623.42 1021.25,-629.42 1015.25,-635.42 1009.25,-635.42"/>
<text text-anchor="middle" x="885" y="-618.12" font-family="Helvetica,sans-Serif" font-size="14.00">NEW CODE:</text>
<text text-anchor="middle" x="885" y="-602.37" font-family="Helvetica,sans-Serif" font-size="14.00">const cwdExists = existsSync(options.cwd)</text>
</g>
<!-- check_binary&#45;&gt;check_cwd -->
<g id="edge8" class="edge">
<title>check_binary&#45;&gt;check_cwd</title>
<path fill="none" stroke="black" d="M885,-751.26C885,-725.1 885,-677.95 885,-646.98"/>
<polygon fill="black" stroke="black" points="888.5,-647.1 885,-637.1 881.5,-647.1 888.5,-647.1"/>
</g>
<!-- detailed_error -->
<g id="node12" class="node">
<title>detailed_error</title>
<path fill="lightblue" stroke="black" d="M1069.62,-519.29C1069.62,-519.29 700.38,-519.29 700.38,-519.29 694.38,-519.29 688.38,-513.29 688.38,-507.29 688.38,-507.29 688.38,-397.29 688.38,-397.29 688.38,-391.29 694.38,-385.29 700.38,-385.29 700.38,-385.29 1069.62,-385.29 1069.62,-385.29 1075.62,-385.29 1081.62,-391.29 1081.62,-397.29 1081.62,-397.29 1081.62,-507.29 1081.62,-507.29 1081.62,-513.29 1075.62,-519.29 1069.62,-519.29"/>
<text text-anchor="middle" x="885" y="-501.99" font-family="Helvetica,sans-Serif" font-size="14.00">NEW CODE:</text>
<text text-anchor="middle" x="885" y="-486.24" font-family="Helvetica,sans-Serif" font-size="14.00">if (!binaryExists) {</text>
<text text-anchor="middle" x="885" y="-470.49" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;throw new Error(&#39;OpenCode binary missing at: &#39; + binaryPath)</text>
<text text-anchor="middle" x="885" y="-454.74" font-family="Helvetica,sans-Serif" font-size="14.00">}</text>
<text text-anchor="middle" x="885" y="-438.99" font-family="Helvetica,sans-Serif" font-size="14.00">if (!cwdExists) {</text>
<text text-anchor="middle" x="885" y="-423.24" font-family="Helvetica,sans-Serif" font-size="14.00"> &#160;throw new Error(&#39;Working directory missing: &#39; + options.cwd)</text>
<text text-anchor="middle" x="885" y="-407.49" font-family="Helvetica,sans-Serif" font-size="14.00">}</text>
<text text-anchor="middle" x="885" y="-391.74" font-family="Helvetica,sans-Serif" font-size="14.00">throw new Error(&#39;Unknown spawn error: &#39; + originalError)</text>
</g>
<!-- check_cwd&#45;&gt;detailed_error -->
<g id="edge9" class="edge">
<title>check_cwd&#45;&gt;detailed_error</title>
<path fill="none" stroke="black" d="M885,-595.52C885,-579.31 885,-554.92 885,-530.9"/>
<polygon fill="black" stroke="black" points="888.5,-531.07 885,-521.07 881.5,-531.07 888.5,-531.07"/>
</g>
<!-- clear_message -->
<g id="node13" class="node">
<title>clear_message</title>
<path fill="lightgreen" stroke="black" d="M944.38,-300.29C944.38,-300.29 741.62,-300.29 741.62,-300.29 735.62,-300.29 729.62,-294.29 729.62,-288.29 729.62,-288.29 729.62,-276.29 729.62,-276.29 729.62,-270.29 735.62,-264.29 741.62,-264.29 741.62,-264.29 944.38,-264.29 944.38,-264.29 950.38,-264.29 956.38,-270.29 956.38,-276.29 956.38,-276.29 956.38,-288.29 956.38,-288.29 956.38,-294.29 950.38,-300.29 944.38,-300.29"/>
<text text-anchor="middle" x="843" y="-276.87" font-family="Helvetica,sans-Serif" font-size="14.00">User sees specific, actionable error</text>
</g>
<!-- detailed_error&#45;&gt;clear_message -->
<g id="edge10" class="edge">
<title>detailed_error&#45;&gt;clear_message</title>
<path fill="none" stroke="black" d="M868.4,-384.89C862.03,-359.41 855.09,-331.66 850.08,-311.61"/>
<polygon fill="black" stroke="black" points="853.49,-310.81 847.67,-301.96 846.7,-312.51 853.49,-310.81"/>
</g>
<!-- outcome3 -->
<g id="node22" class="node">
<title>outcome3</title>
<path fill="#ccffcc" stroke="black" d="M881,-114.96C881,-114.96 667,-114.96 667,-114.96 661,-114.96 655,-108.96 655,-102.96 655,-102.96 655,-90.96 655,-90.96 655,-84.96 661,-78.96 667,-78.96 667,-78.96 881,-78.96 881,-78.96 887,-78.96 893,-84.96 893,-90.96 893,-90.96 893,-102.96 893,-102.96 893,-108.96 887,-114.96 881,-114.96"/>
<text text-anchor="middle" x="774" y="-91.53" font-family="Helvetica,sans-Serif" font-size="14.00">✅ Clear, actionable error messages</text>
</g>
<!-- clear_message&#45;&gt;outcome3 -->
<g id="edge19" class="edge">
<title>clear_message&#45;&gt;outcome3</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M836.51,-264.05C824.54,-232.24 798.9,-164.11 784.45,-125.73"/>
<polygon fill="green" stroke="green" points="787.86,-124.84 781.06,-116.71 781.3,-127.3 787.86,-124.84"/>
</g>
<!-- step1 -->
<g id="node14" class="node">
<title>step1</title>
<path fill="#cce6ff" stroke="black" d="M1370.25,-830.79C1370.25,-830.79 1181.75,-830.79 1181.75,-830.79 1175.75,-830.79 1169.75,-824.79 1169.75,-818.79 1169.75,-818.79 1169.75,-724.04 1169.75,-724.04 1169.75,-718.04 1175.75,-712.04 1181.75,-712.04 1181.75,-712.04 1370.25,-712.04 1370.25,-712.04 1376.25,-712.04 1382.25,-718.04 1382.25,-724.04 1382.25,-724.04 1382.25,-818.79 1382.25,-818.79 1382.25,-824.79 1376.25,-830.79 1370.25,-830.79"/>
<text text-anchor="middle" x="1276" y="-813.49" font-family="Helvetica,sans-Serif" font-size="14.00">STEP 1: Implement Fix 3</text>
<text text-anchor="middle" x="1276" y="-797.74" font-family="Helvetica,sans-Serif" font-size="14.00">(Better diagnostics)</text>
<text text-anchor="middle" x="1276" y="-765.99" font-family="Helvetica,sans-Serif" font-size="14.00">File: src/main/toji/server.ts</text>
<text text-anchor="middle" x="1276" y="-750.24" font-family="Helvetica,sans-Serif" font-size="14.00">Lines: ~280&#45;310 (error handling)</text>
<text text-anchor="middle" x="1276" y="-718.49" font-family="Helvetica,sans-Serif" font-size="14.00">Benefit: Understand errors better</text>
</g>
<!-- step2 -->
<g id="node15" class="node">
<title>step2</title>
<path fill="#cce6ff" stroke="black" d="M1389.25,-675.04C1389.25,-675.04 1122.75,-675.04 1122.75,-675.04 1116.75,-675.04 1110.75,-669.04 1110.75,-663.04 1110.75,-663.04 1110.75,-568.29 1110.75,-568.29 1110.75,-562.29 1116.75,-556.29 1122.75,-556.29 1122.75,-556.29 1389.25,-556.29 1389.25,-556.29 1395.25,-556.29 1401.25,-562.29 1401.25,-568.29 1401.25,-568.29 1401.25,-663.04 1401.25,-663.04 1401.25,-669.04 1395.25,-675.04 1389.25,-675.04"/>
<text text-anchor="middle" x="1256" y="-657.74" font-family="Helvetica,sans-Serif" font-size="14.00">STEP 2: Implement Fix 1</text>
<text text-anchor="middle" x="1256" y="-641.99" font-family="Helvetica,sans-Serif" font-size="14.00">(Prevention)</text>
<text text-anchor="middle" x="1256" y="-610.24" font-family="Helvetica,sans-Serif" font-size="14.00">File: src/main/index.ts</text>
<text text-anchor="middle" x="1256" y="-594.49" font-family="Helvetica,sans-Serif" font-size="14.00">Lines: ~138&#45;142 (after getCurrentProjectPath)</text>
<text text-anchor="middle" x="1256" y="-562.74" font-family="Helvetica,sans-Serif" font-size="14.00">Benefit: Stop bad paths early</text>
</g>
<!-- step1&#45;&gt;step2 -->
<g id="edge11" class="edge">
<title>step1&#45;&gt;step2</title>
<path fill="none" stroke="black" stroke-width="3" d="M1268.38,-711.85C1267.43,-704.56 1266.45,-697.04 1265.48,-689.56"/>
<polygon fill="black" stroke="black" stroke-width="3" points="1268.98,-689.29 1264.22,-679.83 1262.04,-690.2 1268.98,-689.29"/>
</g>
<!-- file1 -->
<g id="node18" class="node">
<title>file1</title>
<path fill="#ffe6cc" stroke="black" d="M1858.88,-325.79C1858.88,-325.79 1665.12,-325.79 1665.12,-325.79 1659.12,-325.79 1653.12,-319.79 1653.12,-313.79 1653.12,-313.79 1653.12,-250.79 1653.12,-250.79 1653.12,-244.79 1659.12,-238.79 1665.12,-238.79 1665.12,-238.79 1858.88,-238.79 1858.88,-238.79 1864.88,-238.79 1870.88,-244.79 1870.88,-250.79 1870.88,-250.79 1870.88,-313.79 1870.88,-313.79 1870.88,-319.79 1864.88,-325.79 1858.88,-325.79"/>
<text text-anchor="middle" x="1762" y="-308.49" font-family="Helvetica,sans-Serif" font-size="14.00">src/main/toji/server.ts</text>
<text text-anchor="middle" x="1762" y="-276.74" font-family="Helvetica,sans-Serif" font-size="14.00">Modify: spawnOpenCodeServer()</text>
<text text-anchor="middle" x="1762" y="-260.99" font-family="Helvetica,sans-Serif" font-size="14.00">Add: Detailed ENOENT checking</text>
<text text-anchor="middle" x="1762" y="-245.24" font-family="Helvetica,sans-Serif" font-size="14.00">Lines affected: ~3&#45;5 new lines</text>
</g>
<!-- step1&#45;&gt;file1 -->
<g id="edge14" class="edge">
<title>step1&#45;&gt;file1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1365.38,-711.55C1380.73,-700.26 1396.17,-688.1 1410,-675.79 1534.43,-565.05 1659.83,-413.4 1721.95,-334.98"/>
<polygon fill="black" stroke="black" points="1724.45,-337.45 1727.9,-327.43 1718.96,-333.11 1724.45,-337.45"/>
</g>
<!-- step3 -->
<g id="node16" class="node">
<title>step3</title>
<path fill="#cce6ff" stroke="black" d="M1379,-511.67C1379,-511.67 1171,-511.67 1171,-511.67 1165,-511.67 1159,-505.67 1159,-499.67 1159,-499.67 1159,-404.92 1159,-404.92 1159,-398.92 1165,-392.92 1171,-392.92 1171,-392.92 1379,-392.92 1379,-392.92 1385,-392.92 1391,-398.92 1391,-404.92 1391,-404.92 1391,-499.67 1391,-499.67 1391,-505.67 1385,-511.67 1379,-511.67"/>
<text text-anchor="middle" x="1275" y="-494.37" font-family="Helvetica,sans-Serif" font-size="14.00">STEP 3: Implement Fix 2</text>
<text text-anchor="middle" x="1275" y="-478.62" font-family="Helvetica,sans-Serif" font-size="14.00">(Safety net)</text>
<text text-anchor="middle" x="1275" y="-446.87" font-family="Helvetica,sans-Serif" font-size="14.00">File: src/main/index.ts &#160;</text>
<text text-anchor="middle" x="1275" y="-431.12" font-family="Helvetica,sans-Serif" font-size="14.00">Lines: ~196&#45;210 (in catch block)</text>
<text text-anchor="middle" x="1275" y="-399.37" font-family="Helvetica,sans-Serif" font-size="14.00">Benefit: Always have working server</text>
</g>
<!-- step2&#45;&gt;step3 -->
<g id="edge12" class="edge">
<title>step2&#45;&gt;step3</title>
<path fill="none" stroke="black" stroke-width="3" d="M1262.91,-555.95C1264.05,-546.32 1265.23,-536.25 1266.4,-526.32"/>
<polygon fill="black" stroke="black" stroke-width="3" points="1269.87,-526.82 1267.56,-516.48 1262.92,-526 1269.87,-526.82"/>
</g>
<!-- file2 -->
<g id="node19" class="node">
<title>file2</title>
<path fill="#ffe6cc" stroke="black" d="M1623.12,-325.79C1623.12,-325.79 1436.88,-325.79 1436.88,-325.79 1430.88,-325.79 1424.88,-319.79 1424.88,-313.79 1424.88,-313.79 1424.88,-250.79 1424.88,-250.79 1424.88,-244.79 1430.88,-238.79 1436.88,-238.79 1436.88,-238.79 1623.12,-238.79 1623.12,-238.79 1629.12,-238.79 1635.12,-244.79 1635.12,-250.79 1635.12,-250.79 1635.12,-313.79 1635.12,-313.79 1635.12,-319.79 1629.12,-325.79 1623.12,-325.79"/>
<text text-anchor="middle" x="1530" y="-308.49" font-family="Helvetica,sans-Serif" font-size="14.00">src/main/index.ts</text>
<text text-anchor="middle" x="1530" y="-276.74" font-family="Helvetica,sans-Serif" font-size="14.00">Modify: Startup sequence</text>
<text text-anchor="middle" x="1530" y="-260.99" font-family="Helvetica,sans-Serif" font-size="14.00">Add: Path validation + fallback</text>
<text text-anchor="middle" x="1530" y="-245.24" font-family="Helvetica,sans-Serif" font-size="14.00">Lines affected: ~15&#45;20 new lines</text>
</g>
<!-- step2&#45;&gt;file2 -->
<g id="edge15" class="edge">
<title>step2&#45;&gt;file2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1358.54,-555.82C1373.42,-544.79 1387.81,-532.52 1400,-519.29 1450.17,-464.86 1487.99,-387.55 1509.55,-336.44"/>
<polygon fill="black" stroke="black" points="1512.73,-337.92 1513.33,-327.35 1506.26,-335.24 1512.73,-337.92"/>
</g>
<!-- test -->
<g id="node17" class="node">
<title>test</title>
<path fill="#b3d9ff" stroke="black" d="M1374.5,-333.67C1374.5,-333.67 1175.5,-333.67 1175.5,-333.67 1169.5,-333.67 1163.5,-327.67 1163.5,-321.67 1163.5,-321.67 1163.5,-242.92 1163.5,-242.92 1163.5,-236.92 1169.5,-230.92 1175.5,-230.92 1175.5,-230.92 1374.5,-230.92 1374.5,-230.92 1380.5,-230.92 1386.5,-236.92 1386.5,-242.92 1386.5,-242.92 1386.5,-321.67 1386.5,-321.67 1386.5,-327.67 1380.5,-333.67 1374.5,-333.67"/>
<text text-anchor="middle" x="1275" y="-316.37" font-family="Helvetica,sans-Serif" font-size="14.00">STEP 4: Test Scenarios</text>
<text text-anchor="middle" x="1275" y="-284.62" font-family="Helvetica,sans-Serif" font-size="14.00">1. Normal startup (existing project)</text>
<text text-anchor="middle" x="1275" y="-268.87" font-family="Helvetica,sans-Serif" font-size="14.00">2. Deleted project startup</text>
<text text-anchor="middle" x="1275" y="-253.12" font-family="Helvetica,sans-Serif" font-size="14.00">3. Missing binary</text>
<text text-anchor="middle" x="1275" y="-237.37" font-family="Helvetica,sans-Serif" font-size="14.00">4. Permission errors</text>
</g>
<!-- step3&#45;&gt;test -->
<g id="edge13" class="edge">
<title>step3&#45;&gt;test</title>
<path fill="none" stroke="black" stroke-width="3" d="M1275,-392.53C1275,-378.2 1275,-362.78 1275,-348.18"/>
<polygon fill="black" stroke="black" stroke-width="3" points="1278.5,-348.46 1275,-338.46 1271.5,-348.46 1278.5,-348.46"/>
</g>
<!-- step3&#45;&gt;file2 -->
<g id="edge16" class="edge">
<title>step3&#45;&gt;file2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1364.19,-392.53C1393.99,-372.9 1426.88,-351.23 1455.45,-332.41"/>
<polygon fill="black" stroke="black" points="1457.28,-335.4 1463.7,-326.97 1453.43,-329.55 1457.28,-335.4"/>
</g>
<!-- outcome4 -->
<g id="node23" class="node">
<title>outcome4</title>
<path fill="#ccffcc" stroke="black" d="M1091.12,-114.96C1091.12,-114.96 922.88,-114.96 922.88,-114.96 916.88,-114.96 910.88,-108.96 910.88,-102.96 910.88,-102.96 910.88,-90.96 910.88,-90.96 910.88,-84.96 916.88,-78.96 922.88,-78.96 922.88,-78.96 1091.12,-78.96 1091.12,-78.96 1097.12,-78.96 1103.12,-84.96 1103.12,-90.96 1103.12,-90.96 1103.12,-102.96 1103.12,-102.96 1103.12,-108.96 1097.12,-114.96 1091.12,-114.96"/>
<text text-anchor="middle" x="1007" y="-91.53" font-family="Helvetica,sans-Serif" font-size="14.00">✅ App never in broken state</text>
</g>
<!-- test&#45;&gt;outcome4 -->
<g id="edge20" class="edge">
<title>test&#45;&gt;outcome4</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1172.07,-230.63C1151.95,-219.39 1131.4,-206.92 1113,-193.92 1082.89,-172.64 1052.03,-143.75 1031.44,-123.24"/>
<polygon fill="green" stroke="green" points="1034.13,-120.99 1024.6,-116.36 1029.16,-125.92 1034.13,-120.99"/>
</g>
<!-- qa -->
<g id="node24" class="node">
<title>qa</title>
<path fill="#ffcccc" stroke="black" d="M1438.78,-106.16C1438.78,-106.16 1372.95,-184.72 1372.95,-184.72 1369.09,-189.32 1359.24,-193.92 1353.24,-193.92 1353.24,-193.92 1214.76,-193.92 1214.76,-193.92 1208.76,-193.92 1198.91,-189.32 1195.05,-184.72 1195.05,-184.72 1129.22,-106.16 1129.22,-106.16 1125.37,-101.56 1125.37,-92.36 1129.22,-87.76 1129.22,-87.76 1195.05,-9.2 1195.05,-9.2 1198.91,-4.6 1208.76,0 1214.76,0 1214.76,0 1353.24,0 1353.24,0 1359.24,0 1369.09,-4.6 1372.95,-9.2 1372.95,-9.2 1438.78,-87.76 1438.78,-87.76 1442.63,-92.36 1442.63,-101.56 1438.78,-106.16"/>
<text text-anchor="middle" x="1284" y="-139.03" font-family="Helvetica,sans-Serif" font-size="14.00">Quality Gates (MANDATORY)</text>
<text text-anchor="middle" x="1284" y="-107.28" font-family="Helvetica,sans-Serif" font-size="14.00">npm run format</text>
<text text-anchor="middle" x="1284" y="-91.53" font-family="Helvetica,sans-Serif" font-size="14.00">npm run lint</text>
<text text-anchor="middle" x="1284" y="-75.78" font-family="Helvetica,sans-Serif" font-size="14.00">npm run typecheck:node</text>
<text text-anchor="middle" x="1284" y="-44.03" font-family="Helvetica,sans-Serif" font-size="14.00">All must pass!</text>
</g>
<!-- test&#45;&gt;qa -->
<g id="edge21" class="edge">
<title>test&#45;&gt;qa</title>
<path fill="none" stroke="red" stroke-width="2" d="M1277.48,-230.71C1277.85,-223.2 1278.24,-215.22 1278.64,-207.06"/>
<polygon fill="red" stroke="red" stroke-width="2" points="1282.14,-207.28 1279.13,-197.13 1275.15,-206.94 1282.14,-207.28"/>
</g>
</g>
</svg>
